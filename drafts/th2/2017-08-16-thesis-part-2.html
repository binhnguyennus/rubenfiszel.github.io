<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>[thesis II] A simulation tool for scala with spatial integration: scala-flow - Ruben Fiszel's website</title>
    <link rel="icon" type="image/png" href="../../images/lambda-xl.png">
      <link rel="stylesheet" type="text/css" href="../../css/syntax.css" />
      <link rel="stylesheet" type="text/css" href="../../sass/main.css" />
      <link type="text/css" href="../../css/font-awesome.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../../fonts/Serif/cmun-serif.css" />
	<link href="http://fonts.googleapis.com/css?family=Droid+Serif" rel="stylesheet" type="text/css">
	  <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
	    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	    </script>
	  </head>
	  <body>
	    <div id="header">
              <div id="logo">
		<img src="../../images/lambda.png" alt="Lambda">
		  <a href="../../">Ruben Fiszel's website</a>
		</div>

		<div id="navigation">
		  <a href="../../">Home</a>
		  <a href="../../about.html">About</a>
		  <a href="../../contact.html">Contact</a>
		</div>
		<div class="clear"></div>
              </div>

              <div id="content">
		<h1> [thesis II] A simulation tool for scala with spatial integration: scala-flow</h1>

		<div class="info">
    Posted on August 16, 2017
    
        by Ruben Fiszel
    
</div>
<div class="post">
  <h3 id="about">About</h3>
<p>This post is the part II out of III of my <a href="assets/thesis.pdf">master thesis</a> at the <a href="http://dawn.cs.stanford.edu/">DAWN lab</a>, Stanford, under <a href="http://arsenalfc.stanford.edu/kunle">Prof. Kunle</a> and <a href="http://lampwww.epfl.ch/~odersky/">Prof. Odersky</a> supervision. The central themes of this thesis are sensor fusion and spatial, an hardware accelerator language (Verilog is also one, but tedious).</p>
<p>This part is about scala-flow, a simulation library with a spatial-lang integration written to ease the prototyping, development and testing of applications that can be represented as data flows with some subpart going through spatial written accelerators.</p>
<h1 id="pt-ii-a-simulation-tool-for-scala-with-spatial-integration-scala-flow">Pt II: A simulation tool for scala with spatial integration: scala-flow</h1>
<h2 id="purpose">Purpose</h2>
<h2 id="source-sink-and-transformations">Source, Sink and Transformations</h2>
<h2 id="flow-graphical-representation">Flow graphical representation</h2>
<h2 id="buffer-and-cycles">Buffer and cycles</h2>
<h2 id="data">Data</h2>
<h2 id="source-api">Source API</h2>
<h3 id="fp">FP</h3>
<p>Here is a simplified description of the API of each source.</p>
<div class="sourceCode"><pre class="sourceCode scala"><code class="sourceCode scala">
<span class="kw">trait</span> Source[A] {

	<span class="kw">def</span> <span class="fu">foreach</span>(f: A =&gt; Unit): Source[A]
	<span class="kw">def</span> <span class="fu">foreachT</span>(f: Timestamped[A] =&gt; Unit): Source[A]
	
	<span class="kw">def</span> <span class="fu">filter</span>(b: A =&gt; Boolean): Source[A]
	<span class="kw">def</span> <span class="fu">filterT</span>(b: Timestamped[Boolean]): Source[A]	
	
	<span class="kw">def</span> <span class="fu">takeWhile</span>(b: A =&gt; Boolean): Source[A]
	<span class="kw">def</span> <span class="fu">takeWhileT</span>(b: Timestamped[A] =&gt; Boolean): Source[A] 
	
	<span class="kw">def</span> <span class="fu">drop</span>(n: Int): Source[A]		
	
	<span class="kw">def</span> muted: Source[A]	
	
	<span class="kw">def</span> <span class="fu">accumulate</span>(clock: Source[Time]): Source[ListT[A]]
	
	<span class="kw">def</span> reduce[B](default: B, f: (B, B) =&gt; B)
		(<span class="kw">implicit</span> ev: A &lt;:&lt; ListT[B]): Source[B]
	<span class="kw">def</span> reduceT[B](default: B,
		          f: (Timestamped[B], Timestamped[B]) =&gt; Timestamped[B])
		(<span class="kw">implicit</span> ev: A &lt;:&lt; List[Timestamped[B]]): Source[B]

	<span class="kw">def</span> groupBy[B](f: A =&gt; B): Source[(B, A)]
    <span class="kw">def</span> groupByT[B](f: Timestamped[A] =&gt; B): Source[(B, A)]	
  
	<span class="kw">def</span> <span class="fu">debug</span>(): Source[A]

	<span class="co">//USE ONLY WHEN THERE IS NO LOOP INVOLVED</span>
	<span class="kw">def</span> <span class="fu">buffer</span>(init: A): Buffer[A]

	<span class="co">//Get old A but with the time of the new A</span>
	<span class="kw">def</span> <span class="fu">bufferWithTime</span>(init: A): Buffer[A]

	<span class="kw">def</span> map[B](f: A =&gt; B): Source[B]
	<span class="kw">def</span> mapT[B](f: Timestamped[A] =&gt; B): Source[B]

	<span class="kw">def</span> flatMap[C](f: A =&gt; List[C]): Source[C]
	<span class="kw">def</span> flatMapT[C](f: Timestamped[A] =&gt; List[Timestamped[C]]): Source[C]	

	<span class="co">//Divide the frequency of the stream by n</span>
	<span class="kw">def</span> <span class="fu">divider</span>(n: Int)

	<span class="co">//Zip everthing</span>
	<span class="co">// A1 A2 B1 A3 B2 B3 B4 B5 A4</span>
	<span class="co">// =&gt; (A1, B1), (A2, B2), (A3, B3), (A4, B4), [Queue[B5]]</span>
	<span class="kw">def</span> zip[B](s2: Source[B])	
	<span class="kw">def</span> zipT[B](s2: Source[B])

	<span class="kw">def</span> unzip2[B, C](<span class="kw">implicit</span> ev: A &lt;:&lt; (B, C)): (Source[B], Source[C]) 

	<span class="co">//Only zip the last of the right</span>
	<span class="co">// A1 A2 B1 A3 B2 B3 B4 B5 A4=&gt; (A1, B1), (A2, B2), (A3, B3), (A4, B5)</span>
	<span class="kw">def</span> zipLastRight[B](s2: Source[B])
		: Source[(Timestamped[A], Timestamped[B])]	
	<span class="kw">def</span> zipLastRightT[B](s2: Source[B])
		: Source[(Timestamped[A], Timestamped[B])]	
	
	<span class="co">//Only zip the last pair</span>
	<span class="co">// A1 A2 B1 A3 B2 B3 A4=&gt; (A1, B1), (A3, B2), (B3, A4)</span>
	<span class="kw">def</span> zipLast[B](s2: Source[B])
		: Source[(Timestamped[A], Timestamped[B])]	
	<span class="kw">def</span> zipLastT[B](s2: Source[B])
		: Source[(Timestamped[A], Timestamped[B])]	
  
	<span class="kw">def</span> merge[B](s2: Source[B]): Source[Either[A, B]]
	
	<span class="kw">def</span> <span class="fu">fusion</span>(sources: Source[A]*): Source[A]
	
	<span class="kw">def</span> <span class="fu">latency</span>(dt: Time): Source[A]
	
	<span class="kw">def</span> toTime: Source[Time]

}

<span class="kw">class</span> <span class="fu">TimeSource</span>(source: Source[Time]) {

  <span class="kw">def</span> <span class="fu">stop</span>(tf: Timeframe): Source[Time]

  <span class="kw">def</span> <span class="fu">latencyVariance</span>(mean: Real, std: Real): Source[Time]
  
  <span class="kw">def</span> <span class="fu">latency</span>(dt: Time): Source[Time] 
  
  <span class="kw">def</span> <span class="fu">deltaTime</span>(init: Time = <span class="fl">0.0</span>): Source[Time]
  
}

<span class="kw">class</span> DataSource[A: Data](source: Source[A]) {

  <span class="kw">def</span> <span class="fu">labelData</span>(f: Time =&gt; A): Source[LabeledData[A]]
  
}</code></pre></div>
<p>The real API includes also a name and silent parameter. Both are useful for the graphical representation. The name of the block will be overriden by name if present and it will be skipped if silent is present.</p>
<h2 id="block">Block</h2>
<h2 id="scheduling">Scheduling</h2>
<h2 id="batch">Batch</h2>
<h2 id="replay">Replay</h2>
<h2 id="spatial-integration">Spatial integration</h2>
<h2 id="conclusion">Conclusion</h2>
<p><strong>TODO</strong></p>
<h2 id="references">References</h2>
</div>
<div class="license" style="margin-left:80%;">
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Licence Creative Commons" style="border-width:0" src="../../images/cc.png" /></a>
</div>

              </div>

	      <hr>

		<div id="footer">
		  <section class="social">
		    <a href="https://ch.linkedin.com/in/rubenfiszel" target="_blank"><i class="fa fa-linkedin fa-2x"></i></a>
		    <a href="https://github.com/rubenfiszel" target="_blank"><i class="fa fa-github fa-2x"></i></a>
		    <a href="mailto:ruben.fiszel@epfl.ch"><i class="fa fa-envelope fa-2x"></i></a>
		    <a href="assets/RubenFiszel_resume.pdf"><i class="fa fa-file fa-2x"></i></a>
		  </section>
		</div>

		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-3040887-4', 'auto');
		  ga('send', 'pageview');

		</script>


	      </body>
	    </html>
